
To study the emulsions' microstructure, we chose to adopt the \textit{nearest particle statistics} framework recently revisited by \citet{zhang2021ensemble}.
We now recall some definitions of the \textit{nearest particle statistics} averaging procedure. 
For further details, readers are encouraged to refer to \citet{zhang2023evolution} on which this work mostly relies.

% \subsubsection*{Theoretical framework}
Let $P(\FF)$ be the probability density function that describes the probability of finding the flow in the configuration $\FF$, where $\FF = (\lambda_1,\lambda_2,\lambda_3,\ldots)$ is a set of all the parameters describing the initial flow configuration.
% \footnote{We assume that the flow can be described by a finite number of parameters related to both phase.}. 
Then, we define $d\mathscr{P} = P(\FF)d\FF$ as the probable number of realizations in the incremental region of the flow' phase space, $d\FF$ around $\FF$.
Additionally,  $\textbf{x}_i(t,\FF)$ and $\textbf{x}_j(\FF,t)$ refers to the Lagrangian position vectors of the particles $i$ and $j$, respectively. 
Note that the particles positions are function of time and of the flow configuration $\FF$. 
% We also introduce the age of the interaction, denoted as $a$, which represents the time elapsed since two particles became nearest neighbors.
Then, the nearest pair probability density function is given by \citep{zhang2021ensemble,zhang2023evolution},
\begin{equation}
    P_{nst}(\textbf{x},\textbf{r},t)= 
    \int \sum_{i}^{N_b}\delta(\textbf{x}-\textbf{x}_i(t,\FF))
    \sum_{j\neq i}^{N_b}\delta(\textbf{x}+\textbf{r}-\textbf{x}_j(t,\FF)) 
    % \delta(t+a-t_c^{ij}) 
    h_{ij} (t,\FF)
    d\mathscr{P},
    \label{eq:P_nstij}
\end{equation}
where we introduced the function $h_{ij}(\FF,t)$, which is defined as,
\begin{equation*}
    h_{ij}(\FF,t)
    = \left\{
        \begin{tabular}{cc}
            $1/n(\FF,t)$ & if $j$ is one of the $n^{th}$ nearest neighbors of $i$ \\
            0& otherwise
        \end{tabular}
        \right.
\end{equation*}
In this definition we considered the situation were $n$ particles could be simultaneously nearest neighbor to the particle $i$. 
In DNS, having two nearest neighbors to one particle may never occur, thus in most of the cases $h_{ij}$ is either $1$ or $0$. 
Nevertheless, the coefficient $1/n$ must be retained in the definition for theoretical consistency.
% Formally, we have $a = t - t^{ij}_c(\FF,t)$.
Consequently, $P_{nst}(\textbf{x},\textbf{r},t)$ is the probability of having a particle center of mass located at $\textbf{x}$ at time $t$ with it nearest neighbor at $\textbf{x}+\textbf{r}$ given that the pair of particles are nearest neighbors. 
Note that $P_\text{nst}(\textbf{x},\textbf{r},t)$ is related to the number density $n_p(\textbf{x},t)$ through the relationship, 
\begin{equation*}
    \int_{\mathbb{R}^3}
     P_\text{nst}(\textbf{x},\textbf{r},t,a) d\textbf{r}  = n_p(\textbf{x},t). 
    \label{eq:Pnst}
\end{equation*}
This establishes consistency between the nearest particle statistic and kinetic theory \citep{zhang2021ensemble}. 


It is convenient to represent the vector \textbf{r} with its radial, polar, and azimuthal coordinates,  $r = |\textbf{r}|$,$\beta$ and $\theta$, respectively. $\theta$ is the angle between the vector \textbf{r} and the vertical direction, and $\beta$ the polar angle defined from $0$ to $2\pi$. In particular, due to the symmetries of the problem under consideration we consider the weighted probability density function $P_\text{nst}^n(r,\theta|\textbf{x},t)$, defined as, 
\begin{equation}
    n_p(\textbf{x},t) P_\text{r}^n(r,\theta|\textbf{x},t)dr d\theta 
    =\frac{1}{2\pi \sin\theta r^2 }
    \int_0^{2\pi}
    % \int_0^\infty 
    P_\text{nst}(\textbf{x},t,r,\theta,\beta) 
    % da 
    d\beta.
    \label{eq:Ptheta_r}
\end{equation}
Since, we model a statistically steady state and homogeneous configuration, the values of $P_\text{nst}^n$ are averaged over the variables $\mathbf{x}$ and $t$ for a given simulation. 
Consequently, for our concern, $P_\text{nst}^n$ is not dependent on $\mathbf{x}$ and $t$, but it remains a function of the global flow parameters :  $Ga$, $\phi$, $Bo$, $\zeta$, and $\lambda$.
Therefore, we drop $\mathbf{x}$ and $t$ in our notation. 


To reconstruct all these statistics from the DNS, we treat each simulation time step  as an independent flow configuration, denoted as $\FF$. 
This is the ergodic hypothesis. 
In fact we collected data for each Lagrangian quantity every $10$ simulation time steps not one. 
The simulation time step is determined either by a Courant Friedrichs Lewy (CFL) condition or by the capillary time step, depending on the dimensionless numbers involved.
On average, $200,000$ time steps are performed during a simulation with $N_b = 125$ droplets. 
This results in a total number of $E = 2,500,000$ events. 
Under this assumption, the ensemble average operators can be rewritten as :
\begin{equation}
    \int \sum_i \delta(\textbf{x}-\textbf{x}_i(\FF,t)) \ldots d\PP
    = \frac{1}{E}\sum_\FF^\text{E} \ldots 
    \label{eq:discrete_ensemble_average}
\end{equation}
where $E$ is the total number of events, which, in our case, corresponds to the total number of time steps simulated.  
When performing conditional average based on the position of the nearest neighboring particle, the methodology is slightly different. 
To reconstruct a quantity such as $P_\text{nst}(\textbf{x},\textbf{r},t)$ we gather all the relative position $\textbf{r}_{ij}(t;\FF)$ from the DNS and store them in $n$ intervals of relative positions $\Delta \textbf{r}_k$ for $k = 1,\ldots, n$.
Then, we apply the discrete ensemble average for each group independently.
Formally, we write, 
\begin{equation}
    P_\text{nst}(\Delta\textbf{r}_k|\textbf{x},t)
    = \frac{1}{E_k} 
    \sum^{E_k}_{\FF_k} 
    1
    \label{eq:vec_cond}
\end{equation}
where $\FF_k$ correspond to the events were the nearest particle pair $i$ and $j$ respects $\textbf{r} \in \Delta \textbf{r}_k$.
$E_k$ is the total number of events fulfilling these constraints. 
Finally, we obtained an approximation of $P_\text{nst}(\textbf{x},\textbf{r},t,a)$ which takes the intervals, $(\Delta\textbf{r}_i)$ as input.

