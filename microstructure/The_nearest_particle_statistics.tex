\section{Nearest particle statistics}
\label{sec:nearest}

We adopted the \textit{nearest particle statistics} framework recently revisited by \citet{zhang2021ensemble} to study the emulsion microstructure.
We now recall some definitions of the \textit{nearest particle statistics} averaging procedure. 
For further details, readers are encouraged to refer to \citet{zhang2021ensemble,zhang2023evolution} on which this work mainly relies.

Let $P(\FF)$ be the probability density function that describes the probability of finding the flow in the configuration $\FF$, where $\FF = (\lambda_1,\lambda_2,\lambda_3,\ldots)$ is the set of all parameters describing the flow configuration.
We then define $d\mathscr{P} = P(\FF)d\FF$ as the probable number of realizations in the incremental region of the flow phase space, $d\FF$ around $\FF$.
Additionally,  $\textbf{x}_i(t,\FF)$ and $\textbf{x}_j(\FF,t)$ refer to the Lagrangian position vectors of the droplets $i$ and $j$, respectively. 
Note that the droplet positions are functions of time and of the flow configuration $\FF$. 
% We also introduce the age of the interaction, denoted as $a$, which represents the time elapsed since two droplets became nearest neighbors.
The nearest pair probability density function is given by \citep{zhang2021ensemble,zhang2023evolution}
\begin{equation}
    P_{nst}(\textbf{r}|\textbf{x},t)= \frac{1}{n_p(\textbf{x},t)}
    \int \sum_{i}^{N_b}\delta[\textbf{x}-\textbf{x}_i(t,\FF)]
    \sum_{j\neq i}^{N_b}\delta[\textbf{x}+\textbf{r}-\textbf{x}_j(t,\FF)]
    % \delta(t+a-t_c^{ij}) 
    h_{ij} (t,\FF)
    d\mathscr{P},
    \label{eq:P_nstij}
\end{equation}
where we introduced the function 
\begin{equation*}
    h_{ij}(\FF,t)
    = \left\{
        \begin{tabular}{cc}
            $1/N_i(\FF,t)$ & if $j$ is one of the $N^{th}_i$ nearest neighbors of $i$ \\
            0& otherwise
        \end{tabular}
        \right. ,
\end{equation*}
and the number density, 
\begin{equation}
    n_p(\textbf{x},t)= 
    \int \sum_{i}^{N_b}\delta[\textbf{x}-\textbf{x}_i(t,\FF)] d\mathscr{P}.
    \label{eq:n_p}
\end{equation}
$P_{nst}(\textbf{r}|\textbf{x},t)$ is the probability density of finding the nearest neighbor at $\textbf{x}+\textbf{r}$ given a droplet already in \textbf{x}.
In this definition, we considered the situation where $N_i(\FF,t)$ droplets could be simultaneously nearest neighbors to the droplet $i$. 
In the DNS, having two nearest neighbors to one droplet may never occur; thus, in most cases, $h_{ij}$ is either $1$ or $0$. 
Nevertheless, the coefficient $1/N_i$ must be retained in the definition for theoretical consistency.
Note that $P_\text{nst}(\textbf{r}|\textbf{x},t)$ is a probability density, therefore we have
\begin{equation*}
    \int_{\mathbb{R}^3}
     P_\text{nst}(\textbf{r}|\textbf{x},t) d\textbf{r}  = 1. 
    \label{eq:Pnst}
\end{equation*}



To collect statistics from the DNS, each simulation timestep is treated as an independent flow configuration. 
Data for each Lagrangian quantity were gathered every 10 simulation timesteps. 
The simulation timestep is determined either by the Courant-Friedrichs-Lewy (CFL) condition or by the capillary timestep, depending on the relevant dimensionless numbers.
On average, $200,000$ timesteps are performed during a simulation with $N_b = 125$ droplets. 
This results in a total of $E = 2,500,000$ events.
$P_\text{nst}(\textbf{r}|\textbf{x},t)$ is obtained by averaging over all events $E$. 
Consequently, for our concern, $P_\text{nst}(\textbf{r}|\textbf{x},t)$ is not dependent on $\mathbf{x}$ and $t$, but remains a function of the global flow parameters :  $Ga$, $\phi$, $Bo$, $\zeta$, and $\lambda$.
Therefore, in the following we drop $\mathbf{x}$ and $t$ in our notation. 

To reconstruct $P_\text{nst}(\textbf{r})$ from DNS all the relative positions $\textbf{r}_{ij}  = \textbf{x}_j - \textbf{x}_i$ are measured and stored in $n$ intervals of the form $[\textbf{r}_k; \textbf{r}_k+\Delta \textbf{r}]$ for $k = 1,\ldots, n$ with $n$ being a positive integer.
Then, the nearest-neighbor probability density function can be obtained discretely as follows
\begin{equation}
    P_\text{nst}(\textbf{r}_k)
    =\lim_{\Delta \textbf{r} \to \bm 0} \frac{E_k}{E \Delta \textbf{r}},
    \label{eq:vec_cond}
\end{equation}
with $E_k$ the total number of events where the nearest droplet pair verifies $\textbf{r}_{ij} \in [\textbf{r}_k ; \textbf{r}_k + \Delta \textbf{r}]$.
Note that $P_\text{nst}(\textbf{r}_k)$ takes discrete values as arguments and is equivalent to $P_\text{nst}(\textbf{r})$ only in the limit $\Delta \textbf{r} \to 0$. 
% For small but finite values of $\Delta \textbf{r}$, we are able to recover an approximation of $P_\text{nst}(\textbf{r})$. 
Furthermore, it is convenient to represent the vector \textbf{r} using radial, polar, and azimuthal coordinates,  $r = |\textbf{r}|$,$\beta$ and $\theta$, respectively. 
$\theta$ is the angle between the vector \textbf{r} and the vertical direction and $\beta$ the polar angle defined from $0$ to $2\pi$. 
In particular, due to the symmetries of the problem under consideration, we assume that
\begin{equation}
    P_\text{nst}(r,\theta)
    = P_\text{nst}(r,\theta,\beta). 
\end{equation}
Let us define $[r_k; r_k+\Delta r]$ and $[\theta_k; \theta_k+\Delta \theta]$  as $2k$ intervals of radial and polar coordinates, respectively. 
Then, the probability density $P_\text{nst}(r,\theta)$ is obtained using the following formula
\begin{equation}
    P_\text{nst}(r_k,\theta_k)
    =
    \lim_{\Delta \theta , \Delta r \to 0}
    % \frac{1}{2\pi \sin\theta r^2 }
    % \int_0^\infty 
    \frac{E_k}{E}
    \frac{1}{2\pi  r_k^2 \sin \theta_k \Delta r \Delta \theta}.
    \label{eq:Ptheta_r}
\end{equation}
In this case, $E_k$ is the total number of events where the nearest droplet pair verifies $r_{ij} \in [r_k ; r_k + \Delta r]$, and $\theta_{ij} \in [\theta_k; \theta_k+d\theta]$, and $2\pi  r_k^2 \sin \theta_k$ serves as the normalization factor. 
Now let us define the radial probability density function  $P_\text{r-nst}(r)$ as the average of $P_\text{nst}(\textbf{r})$ over the surface of a sphere centered at $\textbf{r}=\textbf{0}$ with radius $r$, namely
\begin{equation}
    P_\text{r-nst}(r) = \frac{1}{4\pi }\int_{0}^{2\pi}\int_{0}^{\pi} P_{nst}(r,\theta ,\beta) \sin\theta d\theta d\beta.
    \label{eq:P_r}
\end{equation}
Note that if $P_\text{nst}$ is independent of $\theta$ and $\beta$, then $P_\text{nst-r} = P_\text{nst}$. 
The definition of $P_\text{nst-r}$ based on simulation samples is given by 
\begin{equation}
    P_\text{r-nst}(r_k)
    =
    \lim_{\Delta r \to 0}
    \frac{E_k}{E}
    \frac{1}{4\pi  r_k^2  \Delta r }
    \label{eq:P_r2}
\end{equation}
where $E_k$ is the total number of events where the nearest droplet pair verifies $r_{ij} \in [r_k ; r_k + \Delta r]$, and $4\pi  r_k^2  \Delta r$ corresponds to the volume of the spherical shell containing these neighboring droplets. 

\ref{eq:Ptheta_r} and \ref{eq:P_r2} are exact only in the limit $\Delta r,\Delta \theta  \to 0$. 
However, due to limitations in the number of available samples, we must choose small but finite intervals.
In this work, we use $\Delta \theta = \frac{\pi}{150}$ and $\Delta r = \frac{1}{100}d$, as it will be shown to provide satisfactory results. 
For sake of clarity, we omit the distinction between $P_\text{nst}(r_k,\theta_k)$ and $P_\text{nst}(r,\theta)$ in the next sections. 